import{m as I,aa as x,x as T,j as e,L as M,af as ue,t as S,ab as p,ac as C,r as E,w as G,e as f,f as P,aE as me,aF as _,B as i,aG as he,aH as F,ag as J,D as K,v as R,k as Q,l as Z,n as ee,ak as W,o as ne,R as se,aB as xe,an as je,ao as pe,ar as Ce,ah as Ae,ai as De,aj as Ee,al as Se,I as Y,V as Ie,F as ge,aI as Re,aJ as ke,g as Ue,q as He,aK as Fe,G as Be,a7 as ve,a5 as Me,a6 as Le,a8 as qe,a9 as Oe,ad as fe,aL as _e,au as ze}from"./vendor-DHqJYkmB.js";import{L as j,A as m,e as k,F as V,f as N,H as B,a as L,c as re,C as Xe,G as We,M as Te}from"./index-C-6ao2LN.js";import{H as Ye,O as Je}from"./Columns-BEY8MMHK.js";import{L as Ke}from"./Lazy-DOXiHpru.js";const O=I({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"},ten:{flexBasis:"10%",flexGrow:0},page:{...V,alignItems:"center",justifyContent:"flex-end",paddingTop:S.spacingVerticalXL,columnGap:S.spacingHorizontalM},spin:{width:"4rem"}}),z=new j("Admin","Order"),Qe=[...Ye(z).slice(0,-1),x({columnId:"User",renderHeaderCell:()=>e.jsx(p,{className:O().ten,children:"User"}),renderCell(n){return e.jsx(C,{className:O().ten,children:n.User})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(p,{className:O().two,children:"Action"}),renderCell(n){return e.jsx(C,{className:O().twoc,children:e.jsx(Je,{OrderId:n.Id,ParentLog:z,Admin:!0})})}})];function Ze(){const n=O(),{data:s}=T(()=>m.Order.Get.Count(),{onError:z.error}),r=Math.ceil((s||1)/30),{data:t,run:o}=T(l=>m.Order.Get.List(l,z),{defaultParams:[1],debounceWait:300,onError:z.error});return e.jsxs(e.Fragment,{children:[e.jsx(k,{Items:t,Columns:Qe}),e.jsxs("div",{className:n.page,children:[e.jsxs(M,{children:["Total ",s," Records"]}),e.jsx(ue,{min:1,max:r,defaultValue:1,className:n.spin,onChange:(l,a)=>{const c=parseInt(a.value||a.displayValue);!isNaN(c)&&c&&c<=r&&o(c)}}),e.jsx(M,{children:"/"}),e.jsx(M,{children:r})]})]})}const en=I({body:{...V,alignItems:"center"},input:{flexGrow:1}}),te=new j("Admin","Product","Detail","Category");function nn({ProdId:n}){const[s,r]=E.useState(""),[t,{setTrue:o,setFalse:l}]=G();T(()=>m.Product.Get.Category(n),{onSuccess(y){y&&r(y)},onError:te.error});const{dispatch:a,dispatchToast:c}=N(te),{run:u}=m.Product.Patch.useCategory({manual:!0,onError(y,v){a({Message:"Failed Update Category",Request:v,Error:y})},onSuccess(){c(e.jsx(f,{children:e.jsx(P,{children:"Category Updated"})}),{intent:"success"}),l()}}),{run:b}=m.Product.Delete.useCategory({manual:!0,onError(y,v){a({Message:"Failed Detach Category",Request:v,Error:y})},onSuccess(){c(e.jsx(f,{children:e.jsx(P,{children:"Category Detached"})}),{intent:"success"}),l()}}),{data:d}=T(()=>B.Gallery.Get.Categories(),{onSuccess(y){w(y)},onError:te.error}),[h,w]=E.useState(d),[g,A]=E.useState(""),D=en();return e.jsxs("div",{className:D.body,children:[e.jsx(M,{size:"large",disabled:!t,children:"Category"}),e.jsxs(me,{className:D.input,size:"large",disabled:!t,freeform:!0,placeholder:s||"Pending",appearance:"underline",onChange:y=>{const v=y.target.value.trim(),$=d?.filter($e=>$e.toLowerCase().indexOf(v.toLowerCase())===0);w($),v&&$&&$.length<1?A(v):A("")},onOptionSelect:(y,v)=>{const $=v.optionText;r($),$&&d?.includes($)?A(""):A($)},children:[g&&e.jsxs(_,{text:g,children:['Create New "',g,'"']},g),h?.map(y=>e.jsx(_,{children:y},y)),h?.length===d?.length?e.jsx(_,{text:"",children:"Pending"},""):null]}),t?e.jsx(i,{appearance:"subtle",icon:e.jsx(he,{}),onClick:()=>{s?u(n,s):b(n)}}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:o})]})}const sn=new j("Admin","Product","Detail","Combo","Delete");function rn({ComboId:n,Refresh:s}){const{dispatch:r,dispatchToast:t}=N(sn),{run:o}=m.Product.Delete.useCombo({manual:!0,onError(l,a){r({Message:"Failed Delete Combo",Request:a,Error:l})},onSuccess(){t(e.jsx(f,{children:e.jsx(P,{children:"Combo Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>o(n)})}const tn=[x({columnId:"Variant",renderHeaderCell:()=>e.jsx(p,{children:"Variant"}),renderCell(n){return e.jsx(C,{children:n.Name})}}),x({columnId:"Type",renderHeaderCell:()=>e.jsx(p,{children:"Type"}),renderCell(n){return e.jsx(C,{children:e.jsx(me,{defaultValue:n.Current,defaultSelectedOptions:[n.Current],onOptionSelect:(s,r)=>n.Update(r.optionValue),children:n.Types.map((s,r)=>e.jsx(_,{children:s},r))})})}})],an=I({body:{...V,justifyContent:"flex-end",alignItems:"center",columnGap:S.spacingVerticalM,marginTop:S.spacingHorizontalM}}),ae=new j("Admin","Product","Detail","Combo","Detail");function on({Id:n,ProdId:s,Combo:r,Stock:t,Refresh:o}){const[l,{toggle:a}]=G(),[c,u]=E.useState(r),[b,d]=E.useState(t),{data:h}=T(()=>m.Product.Get.Variants(s,ae),{onError:ae.error}),{dispatch:w,dispatchToast:g}=N(ae),{run:A}=m.Product.Patch.useCombo({manual:!0,onError(D,y){w({Message:"Failed Update Combo",Request:y,Error:D})},onSuccess(){g(e.jsx(f,{children:e.jsx(P,{children:"Combo Updated"})}),{intent:"success"}),o(),a()}});return e.jsxs(K,{open:l,onOpenChange:a,children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(Q,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(W,{})})}),children:"Combo Detail"}),e.jsxs(ne,{children:[e.jsx(k,{Items:h?.map(D=>({Current:c[D.Name],Update(y){c[D.Name]=y,u({...c})},...D})),Columns:tn}),e.jsxs("div",{className:an().body,children:[e.jsx(M,{children:"Stock"}),e.jsx(ue,{value:b,min:0,onChange:(D,y)=>{const v=parseInt(y.value||y.displayValue);isNaN(v)||v<0||d(v)}}),e.jsx(i,{appearance:"primary",onClick:()=>A(n,c,b),children:"Submit"})]})]})]})})]})}const cn=[x({columnId:"Variant",renderHeaderCell:()=>e.jsx(p,{children:"Variant"}),renderCell(n){return e.jsx(C,{children:n.Name})}}),x({columnId:"Type",renderHeaderCell:()=>e.jsx(p,{children:"Type"}),renderCell(n){return e.jsx(C,{children:e.jsx(me,{onOptionSelect:(s,r)=>n.Update(r.optionValue),children:n.Types.map((s,r)=>e.jsx(_,{children:s},r))})})}})],ln=I({body:{...V,justifyContent:"flex-end",alignItems:"center",columnGap:S.spacingVerticalM,marginTop:S.spacingHorizontalM}}),oe=new j("Admin","Product","Detail","Combo","NewCombo");function dn({ProdId:n,Refresh:s}){const[r,{toggle:t}]=G(),[o,l]=E.useState({}),[a,c]=E.useState(1),{data:u}=T(()=>m.Product.Get.Variants(n,oe),{onSuccess(w){for(const g of w)o[g.Name]="";l({...o})},onError:oe.error}),{dispatch:b,dispatchToast:d}=N(oe),{run:h}=m.Product.Post.useCombo({manual:!0,onError(w,g){b({Message:"Failed Create Combo",Request:g,Error:w})},onSuccess(){d(e.jsx(f,{children:e.jsx(P,{children:"Combo Created"})}),{intent:"success"}),s(),t()}});return e.jsxs(K,{open:r,onOpenChange:t,children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(se,{}),children:"New Combo"})}),e.jsx(Q,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(W,{})})}),children:"New Combo"}),e.jsxs(ne,{children:[e.jsx(k,{Items:u?.map(w=>({Update(g){o[w.Name]=g,l({...o})},...w})),Columns:cn}),e.jsxs("div",{className:ln().body,children:[e.jsx(M,{children:"Stock"}),e.jsx(ue,{value:a,min:0,onChange:(w,g)=>{const A=parseInt(g.value||g.displayValue);isNaN(A)||A<0||c(A)}}),e.jsx(i,{appearance:"primary",onClick:()=>h(n,o,a),children:"Create"})]})]})]})})]})}const U=I({body:{...V,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},five:{flexBasis:"5%",flexGrow:0}}),Pe=new j("Admin","Product","Detail","Combo"),un=[x({columnId:"Id",renderHeaderCell:()=>e.jsx(p,{className:U().four,children:"Id"}),renderCell(n){return e.jsx(C,{className:U().four,children:n.Id})}}),x({columnId:"Combo",renderHeaderCell:()=>e.jsx(p,{children:"Combo"}),renderCell(n){return e.jsx(C,{children:Object.entries(n.Combo).reduce((s,r)=>`${s} ${r[0]} : ${r[1]} ;`,"")})}}),x({columnId:"Stock",renderHeaderCell:()=>e.jsx(p,{className:U().five,children:"Stock"}),renderCell(n){return e.jsx(C,{className:U().five,children:n.Stock})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(p,{className:U().seven,children:"Action"}),renderCell(n){return e.jsxs(C,{className:U().seven,children:[e.jsx(on,{...n}),e.jsx(rn,{ComboId:n.Id,Refresh:n.Refresh})]})}})];function mn({ProdId:n}){const{data:s,run:r}=T(()=>B.Product.Get.ComboItem(n,Pe),{onError:Pe.error});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:U().body,children:[e.jsx(xe,{children:"Combo"}),e.jsx(dn,{ProdId:n,Refresh:r})]}),e.jsx(k,{Items:s?.map(t=>({ProdId:n,Refresh:r,...t})),Columns:un})]})}const hn=new j("Admin","Product","Detail","Delete"),xn=I({root:{...L,rowGap:S.spacingHorizontalS}});function jn({ProdId:n}){const{Nav:s}=re(),{dispatch:r,dispatchToast:t}=N(hn),{run:o,loading:l}=m.Product.Delete.useProduct({manual:!0,onError(c,u){r({Message:"Failed Delete Product",Request:u,Error:c})},onSuccess(){t(e.jsx(f,{children:e.jsx(P,{children:"Product Deleted"})}),{intent:"success"}),s("/Admin")}}),a=xn();return e.jsx("div",{children:e.jsxs(je,{withArrow:!0,children:[e.jsx(pe,{disableButtonEnhancement:!0,children:e.jsx(i,{children:"Delete Product"})}),e.jsxs(Ce,{className:a.root,children:["Are You Sure?",e.jsx(i,{disabled:l,appearance:"primary",onClick:()=>o(n),children:"Yes"})]})]})})}const pn=I({btn:{...V,columnGap:S.spacingVerticalS},drawer:{width:"1100px"}}),Cn=new j("Admin","Product","Lexical");function gn({ProdId:n}){const s=pn(),[r,{toggle:t,setTrue:o}]=G(),{data:l,run:a}=T(()=>B.Product.Get.Lexical(n)),{dispatch:c,dispatchToast:u}=N(Cn),{run:b}=m.Product.Post.useLexical({manual:!0,onError(d,h){c({Message:"Failed Update Description",Request:h,Error:d})},onSuccess(){u(e.jsx(f,{children:e.jsx(P,{children:"Description Updated"})}),{intent:"success"}),a(),t()}});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(i,{onClick:()=>o(),children:"Open Description Editor"})}),e.jsxs(Ae,{open:r,onOpenChange:t,position:"start",size:"large",modalType:"alert",className:s.drawer,children:[e.jsx(De,{children:e.jsx(Ee,{action:e.jsxs("div",{className:s.btn,children:[e.jsx(i,{appearance:"primary",onClick:()=>b(n),children:"Save"}),e.jsx(i,{onClick:()=>t(),children:"Cancel"})]}),children:"Edit Product Description"})}),e.jsx(Se,{children:e.jsx(Ke,{State:l?.Description})})]})]})}const be=new j("Admin","Product","Detail","Name");function fn({ProdId:n}){const[s,r]=E.useState(""),[t,{setTrue:o,setFalse:l}]=G(),{Nav:a}=re();T(()=>m.Product.Get.Name(n),{onSuccess(d){r(d)},onError(d){a("Admin"),be.error(d)}});const{dispatch:c,dispatchToast:u}=N(be),{run:b}=m.Product.Patch.useName({manual:!0,onError(d,h){c({Message:"Failed Update Name",Request:h,Error:d})},onSuccess(){u(e.jsx(f,{children:e.jsx(P,{children:"Name Updated"})}),{intent:"success"}),l()}});return e.jsx(Y,{size:"large",value:s,disabled:!t,appearance:"underline",onChange:(d,h)=>r(h.value),contentBefore:e.jsx(Ie,{children:"Name"}),contentAfter:t?e.jsx(i,{appearance:"subtle",icon:e.jsx(he,{}),onClick:()=>b(n,s)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:o})})}const Pn=new j("Admin","Product","Detail","Photo","Edit","Caption");function bn({Id:n,Caption:s}){const[r,t]=E.useState(s||""),{dispatch:o,dispatchToast:l}=N(Pn),{run:a}=m.Product.Patch.useCaption({manual:!0,onError(c,u){o({Message:"Failed Update Caption",Request:u,Error:c})},onSuccess(){l(e.jsx(f,{children:e.jsx(P,{children:"Caption Updated"})}),{intent:"success"})}});return e.jsxs(e.Fragment,{children:[e.jsx(ge,{label:"Caption",children:e.jsx(Y,{value:r,placeholder:"Write some infomation here?",onChange:(c,u)=>t(u.value)})}),e.jsx(i,{onClick:()=>a(n,r),children:"Save Caption"})]})}const yn=new j("Admin","Product","Detail","Photo","Edit","Delete");function wn({Id:n,ProductId:s}){const{dispatch:r,dispatchToast:t}=N(yn),{run:o}=m.Product.Delete.usePhoto({manual:!0,onError(l,a){r({Message:"Failed Delete Photo",Request:a,Error:l})},onSuccess(){t(e.jsx(f,{children:e.jsx(P,{children:"Photo Deleted"})}),{intent:"success"})}});return e.jsx(i,{appearance:"primary",onClick:()=>o(s,n),children:"Delete"})}const ye=new j("Admin","Product","Detail","Photo","Edit","Replace");function Nn({Id:n}){const{dispatch:s,dispatchToast:r}=N(ye),{run:t}=m.Product.Patch.usePhoto(ye,{manual:!0,onBefore([o,l]){r(e.jsx(f,{children:e.jsxs(P,{children:["Uploading Photo ",l.name," for Product ",o," to replace ",n]})}),{intent:"info"})},onError(o,l){s({Message:"Failed Update Photo",Request:l,Error:o})},onSuccess(){r(e.jsx(f,{children:e.jsx(P,{children:"Photo Updated"})}),{intent:"success"})}});return e.jsx(i,{onClick:()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=()=>{o.files&&t(n,o.files[0])},o.click()},children:"Replace"})}const An=I({box:{...V,columnGap:S.spacingHorizontalL},img:{...Xe,aspectRatio:"1",width:"50%"},cap:{...L,flexGrow:1,rowGap:S.spacingVerticalL}}),Dn=new j("Admin","Product","Detail","Photo","Edit");function En(n){const{Id:s,Cover:r}=n,t=An();return e.jsxs(K,{children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(Q,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(W,{})})}),children:"Image Detail"}),e.jsxs(ne,{className:t.box,children:[e.jsx(We,{shape:"rounded",className:t.img,Guid:r,Log:Dn}),e.jsxs("div",{className:t.cap,children:[e.jsx(bn,{...n}),e.jsx(Nn,{Id:s}),e.jsx(wn,{...n})]})]})]})})]})}function Sn(n){const{Id:s,ProductId:r,ParentLog:t}=n,{dispatch:o}=N(t),{mutate:l}=B.Product.Get.usePhotoList(r,t),{run:a}=m.Product.Post.useMovePhoto({manual:!0,onError(c,u){o({Message:"Failed Update Order",Request:u,Error:c})},onSuccess:(c,[u,b])=>l(d=>{const h=d[0],w=h.findIndex(D=>D.PhotoId===s);if(w===-1)return d;const g=b?w-1:w+1;if(g<0||g>=h.length)return d;const A=h[w];return h[w]=h[g],h[g]=A,d})});return e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(Re,{}),onClick:()=>a(s,!0)}),e.jsx(i,{appearance:"subtle",icon:e.jsx(ke,{}),onClick:()=>a(s,!1)}),e.jsx(En,{...n})]})}const ce=I({f11:{flexBasis:"11%",flexGrow:0},box:{...V,justifyContent:"space-between"}}),X=new j("Admin","Product","Detail","Photo"),In=[Te(70,X),x({columnId:"Caption",renderHeaderCell:()=>e.jsx(p,{children:"Caption"}),renderCell(n){return e.jsx(C,{children:n.Caption||"No Caption"})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(p,{className:ce().f11,children:"Action"}),renderCell(n){return e.jsx(C,{className:ce().f11,children:e.jsx(Sn,{...n,ParentLog:X})})}})];function vn({ProdId:n}){const{data:s}=B.Product.Get.usePhotoList(n,X),r=s?s[0].map(a=>({Id:a.PhotoId,Cover:a.ObjectId,Caption:a.Caption,ProductId:a.ProductId})):void 0,{dispatch:t,dispatchToast:o}=N(X),{run:l}=m.Product.Post.usePhoto(X,{manual:!0,onBefore([a,c]){o(e.jsx(f,{children:e.jsxs(P,{children:["Uploading Photo ",c.name," for Product ",a]})}),{intent:"info"})},onError(a,c){t({Message:"Failed Upload Photo",Request:c,Error:a})},onSuccess(){o(e.jsx(f,{children:e.jsx(P,{children:"Photo Uploaded"})}),{intent:"success"})}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:ce().box,children:[e.jsx(xe,{children:"Photos"}),e.jsx(i,{appearance:"primary",icon:e.jsx(se,{}),onClick:()=>{const a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=()=>{a.files&&l(n,a.files[0])},a.click()},children:"New Image"})]}),e.jsx(k,{Items:r,Columns:In})]})}const Tn=new j("Admin","Product","Detail","Variant","Delete");function Gn({VariantId:n,Refresh:s}){const{dispatch:r,dispatchToast:t}=N(Tn),{run:o}=m.Product.Delete.useVariant({manual:!0,onError(l,a){r({Message:"Failed Delete Variant",Request:a,Error:l})},onSuccess(){t(e.jsx(f,{children:e.jsx(P,{children:"Variant Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>o(n)})}const Vn=new j("Admin","Product","Detail","Variant","Edit","TypeDelete");function $n({VariantId:n,Type:s,Refresh:r}){const{dispatch:t,dispatchToast:o}=N(Vn),{run:l}=m.Product.Delete.useType({manual:!0,onError(a,c){t({Message:"Failed Delete Type",Request:c,Error:a})},onSuccess(){o(e.jsx(f,{children:e.jsx(P,{children:"Type Deleted"})}),{intent:"success"}),r()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>l(n,s)})}const Rn=new j("Admin","Product","Detail","Variant","Edit","Name");function kn({Id:n,Name:s}){const[r,t]=E.useState(s),[o,{setTrue:l,setFalse:a}]=G(),{dispatch:c,dispatchToast:u}=N(Rn),{run:b}=m.Product.Patch.useVariantName({manual:!0,onError(d,h){c({Message:"Failed Update Variant Name",Request:h[0],Error:d})},onSuccess(){u(e.jsx(f,{children:e.jsx(P,{children:"Variant Name Updated"})}),{intent:"success"}),a()}});return e.jsx(Y,{size:"large",value:r,disabled:!o,appearance:"underline",onChange:(d,h)=>t(h.value),contentBefore:e.jsx(Ie,{children:"Name"}),contentAfter:o?e.jsx(i,{appearance:"subtle",icon:e.jsx(he,{}),onClick:()=>b(n,r)}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{}),onClick:l})})}const Un=I({body:{...L,rowGap:S.spacingVerticalM}}),Hn=new j("Admin","Product","Detail","Variant","Edit","Type");function Ge({VariantId:n,Type:s,Refresh:r,New:t}){const o=Un(),[l,{toggle:a}]=G(),[c,u]=E.useState(s||""),{dispatch:b,dispatchToast:d}=N(Hn),h={manual:!0,onError(A,D){b({Message:`Failed ${t?"Create":"Update"} Type ${c}`,Request:D,Error:A})},onSuccess(A){d(e.jsxs(f,{children:[e.jsxs(P,{children:["Type ",t?"Created":"Updated"]}),e.jsxs(Ue,{children:[A," ",c]})]}),{intent:"success"}),r(),u(""),a()}},{run:w}=m.Product.Post.useType(h),{run:g}=m.Product.Patch.useType(h);return e.jsxs(je,{withArrow:!0,open:l,onOpenChange:a,children:[e.jsx(pe,{disableButtonEnhancement:!0,children:t?e.jsx(i,{icon:e.jsx(se,{}),appearance:"primary",children:"New Type"}):e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsxs(Ce,{className:o.body,children:[e.jsx(ge,{label:"Type Name",children:e.jsx(Y,{value:c,onChange:(A,D)=>u(D.value)})}),e.jsx(i,{onClick:()=>t?w(n,c):g(n,s,c),children:"Submit"})]})]})}const le=I({body:{...L,rowGap:S.spacingVerticalM},twelve:{flexBasis:"12%",flexGrow:0}}),Fn=[x({columnId:"Name",renderHeaderCell:()=>e.jsx(p,{children:"Name"}),renderCell(n){return e.jsx(C,{children:n.Name})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(p,{className:le().twelve,children:"Action"}),renderCell(n){return e.jsxs(C,{className:le().twelve,children:[e.jsx(Ge,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh}),e.jsx($n,{VariantId:n.VariantId,Type:n.Name,Refresh:n.Refresh})]})}})];function Bn({Variant:n,Refresh:s}){return e.jsxs(K,{children:[e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(F,{})})}),e.jsx(Q,{children:e.jsxs(Z,{children:[e.jsx(ee,{action:e.jsx(R,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"subtle",icon:e.jsx(W,{})})}),children:"Variant Detail"}),e.jsxs(ne,{className:le().body,children:[e.jsx(kn,{Id:n.Id,Name:n.Name}),e.jsx(k,{Items:n.Types.map((r,t)=>({Id:t,Name:r,VariantId:n.Id,Refresh:s})),Columns:Fn})]}),e.jsx(He,{children:e.jsx(Ge,{VariantId:n.Id,Refresh:s,New:!0})})]})})]})}const Mn=I({body:{...L,rowGap:S.spacingVerticalM}}),Ln=new j("Admin","Product","Detail","Variant","New");function qn({ProdId:n,Refresh:s}){const r=Mn(),[t,{toggle:o}]=G(),[l,a]=E.useState(""),{dispatch:c,dispatchToast:u}=N(Ln),{run:b}=m.Product.Post.useVariant({manual:!0,onError(d,h){c({Message:"Failed Create Variant",Request:h,Error:d})},onSuccess(){u(e.jsx(f,{children:e.jsx(P,{children:"Variant Created"})}),{intent:"success"}),s(),a(""),o()}});return e.jsxs(je,{withArrow:!0,open:t,onOpenChange:o,children:[e.jsx(pe,{disableButtonEnhancement:!0,children:e.jsx(i,{appearance:"primary",icon:e.jsx(se,{}),children:"New Variant"})}),e.jsxs(Ce,{className:r.body,children:[e.jsx(ge,{required:!0,label:"Variant Name",children:e.jsx(Y,{value:l,onChange:(d,h)=>a(h.value)})}),e.jsx(i,{onClick:()=>b(n,l),children:"Add"})]})]})}const H=I({body:{...V,justifyContent:"space-between"},four:{flexBasis:"4%",flexGrow:0},seven:{flexBasis:"7%",flexGrow:0},twelve:{flexBasis:"12%",flexGrow:0}}),we=new j("Admin","Product","Detail","Variant"),On=[x({columnId:"Id",renderHeaderCell:()=>e.jsx(p,{className:H().four,children:"Id"}),renderCell(n){return e.jsx(C,{className:H().four,children:n.Id})}}),x({columnId:"Name",renderHeaderCell:()=>e.jsx(p,{className:H().twelve,children:"Name"}),renderCell(n){return e.jsx(C,{className:H().twelve,children:n.Name})}}),x({columnId:"Type",renderHeaderCell:()=>e.jsx(p,{children:"Type"}),renderCell(n){return e.jsx(C,{children:n.Types.reduce((s,r)=>`${s} ${r} ;`,"")})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(p,{className:H().seven,children:"Action"}),renderCell(n){return e.jsxs(C,{className:H().seven,children:[e.jsx(Bn,{Variant:n,Refresh:ie}),e.jsx(Gn,{VariantId:n.Id,Refresh:ie})]})}})];let ie;function _n({ProdId:n}){const s=H(),{data:r,run:t}=T(()=>m.Product.Get.Variants(n,we),{onError:we.error});return ie=t,e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.body,children:[e.jsx(xe,{children:"Variant"}),e.jsx(qn,{ProdId:n,Refresh:t})]}),e.jsx(k,{Items:r,Columns:On})]})}const zn=I({body:{...L,rowGap:S.spacingVerticalXL,paddingBottom:S.spacingVerticalXXXL}});function Xn({ProdId:n}){const s=zn(),[r,{setFalse:t,setTrue:o}]=G(),{Nav:l,Paths:a}=re(),c=parseInt(a.at(1));return E.useEffect(()=>{c===n?o():t()},[a]),e.jsxs(e.Fragment,{children:[e.jsx(i,{appearance:"subtle",icon:e.jsx(Fe,{}),onClick:()=>{l("Admin",n),o()}}),e.jsxs(Ae,{open:r,position:"end",size:"large",modalType:"alert",children:[e.jsx(De,{children:e.jsx(Ee,{action:e.jsx(i,{appearance:"subtle",icon:e.jsx(W,{}),onClick:()=>{l("Admin"),t()}}),children:"Product Detail"})}),e.jsxs(Se,{className:s.body,children:[e.jsx(fn,{ProdId:n}),e.jsx(nn,{ProdId:n}),e.jsx(vn,{ProdId:n}),e.jsx(_n,{ProdId:n}),e.jsx(mn,{ProdId:n}),e.jsx(gn,{ProdId:n}),e.jsx(jn,{ProdId:n})]})]})]})}const q=new j("Admin","Product","Row");function Wn({item:n}){const[s,r]=E.useState(()=>({Id:n,Cover:"",Name:"Loading..."})),[t,{setTrue:o}]=G(),l=B.Product.Get;return Be(async()=>{const a=await l.Product(n).catch(q.error);if(!a)return q.warn(`Product ${n} Not Found`),o();let c={...s,Name:a.Name,Category:a.Category||"Pending"};r(c);const[u,b]=await l.PhotoList(n,q);b||q.warn(`Product ${n} has no photo`),r(c={...c,Cover:b});const d=await m.Product.Get.Count(n).catch(q.error);d&&r({...c,...d})},[]),t?null:e.jsx(ve,{children:({renderCell:a})=>a(s)},n)}const Ne=I({two:{flexBasis:"2.5%",flexGrow:0},twoc:{flexBasis:"2.5%",flexGrow:0,justifyContent:"center"}}),Ve=new j("Admin","Product"),Yn=[Te(50,Ve),x({columnId:"Product",renderHeaderCell:()=>e.jsx(p,{children:"Product"}),renderCell(n){return e.jsx(C,{children:e.jsx(fe,{children:n.Name})})}}),x({columnId:"Category",renderHeaderCell:()=>e.jsx(p,{children:"Category"}),renderCell(n){return e.jsx(C,{children:e.jsx(fe,{children:n.Category})})}}),x({columnId:"Variant",renderHeaderCell:()=>e.jsx(p,{children:"Variant"}),renderCell(n){return e.jsx(C,{children:n.Variant})}}),x({columnId:"Combo",renderHeaderCell:()=>e.jsx(p,{children:"Combo"}),renderCell(n){return e.jsx(C,{children:n.Combo})}}),x({columnId:"Stock",renderHeaderCell:()=>e.jsx(p,{children:"Stock"}),renderCell(n){return e.jsx(C,{children:n.Stock})}}),x({columnId:"Action",renderHeaderCell:()=>e.jsx(p,{className:Ne().two,children:"Detail"}),renderCell(n){return e.jsx(C,{className:Ne().twoc,children:e.jsx(Xn,{ProdId:n.Id})})}})];function Jn(){const n=m.Product.Get.useList(Ve);return e.jsxs(Me,{items:n?n.reverse():[],columns:Yn,children:[e.jsx(Le,{children:e.jsx(ve,{children:({renderHeaderCell:s})=>s()})}),e.jsx(qe,{children:s=>e.jsx(Wn,{...s})}),!n&&e.jsx(Oe,{size:48})]})}const Kn=new j("Admin","User","Delete");function Qn({UserId:n,Refresh:s}){const{dispatch:r,dispatchToast:t}=N(Kn),{run:o}=m.User.Delete.useUser({manual:!0,onError(l,a){r({Message:"Failed Delete User",Request:a,Error:l})},onSuccess(){t(e.jsx(f,{children:e.jsx(P,{children:"User Deleted"})}),{intent:"success"}),s()}});return e.jsx(i,{appearance:"subtle",icon:e.jsx(J,{}),onClick:()=>o(n)})}const Zn=new j("Admin","User","Grant");function es({UserId:n,Admin:s,Refresh:r}){const{dispatch:t,dispatchToast:o}=N(Zn),{run:l}=m.User.Post.useAdmin({manual:!0,onError(c,u){t({Message:"Failed Grant Admin",Request:u,Error:c})},onSuccess(){o(e.jsx(f,{children:e.jsx(P,{children:"Admin Granted"})}),{intent:"success"}),r()}}),{run:a}=m.User.Delete.useAdmin({manual:!0,onError(c,u){t({Message:"Failed Revoke Admin",Request:u,Error:c})},onSuccess(){o(e.jsx(f,{children:e.jsx(P,{children:"Admin Revoked"})}),{intent:"success"}),r()}});return e.jsx(_e,{checked:s,onChange:(c,u)=>{u.checked?l(n):a(n)}})}const ns=new j("Admin","User"),ss=[x({columnId:"Id",renderHeaderCell:()=>"Id",renderCell(n){return n.Id}}),x({columnId:"Name",renderHeaderCell:()=>"Real Name",renderCell(n){return n.Name}}),x({columnId:"Email",renderHeaderCell:()=>"E-Mail",renderCell(n){return n.EMail}}),x({columnId:"Admin",renderHeaderCell:()=>"Admin",renderCell(n){return e.jsx(es,{UserId:n.Id,Admin:n.Admin,Refresh:de})}}),x({columnId:"Delete",renderHeaderCell:()=>"Delete",renderCell(n){return e.jsx(Qn,{UserId:n.Id,Refresh:de})}})].map(({renderHeaderCell:n,renderCell:s,...r})=>({...r,renderHeaderCell:()=>e.jsx(p,{children:n()}),renderCell:t=>e.jsx(C,{children:s(t)})}));let de;function rs(){const{data:n,run:s}=T(()=>m.User.Get.List(),{onError:ns.error});return de=s,e.jsx(k,{Items:n,Columns:ss})}const ts=new j("Admin");function is(){const{Paths:n,Nav:s}=re(),r=n.at(1),t=E.useMemo(()=>{switch(r){case"Order":return e.jsx(Ze,{});case"User":return e.jsx(rs,{});default:return e.jsx(Jn,{})}},[r]),{data:o}=B.User.Get.useMe(ts);return o?o.Admin?t:s("/"):e.jsx(ze,{size:"huge",label:"Authenticating..."})}export{is as default};
